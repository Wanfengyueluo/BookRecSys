# Book-Server

## 代码

## 注意问题

首先

原数据集中的用户数据并没有使用

需要重新注册用户

1. 新建SpringBoot项目，添加依赖

   ```xml
   <?xml version="1.0" encoding="UTF-8"?>
   <project xmlns="http://maven.apache.org/POM/4.0.0"
            xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
            xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
       <modelVersion>4.0.0</modelVersion>
   
       <groupId>org.example</groupId>
       <artifactId>book-server</artifactId>
       <version>1.0-SNAPSHOT</version>
       <parent>
           <groupId>org.springframework.boot</groupId>
           <artifactId>spring-boot-starter-parent</artifactId>
           <version>2.0.4.RELEASE</version><!-- lookup parent from repository -->
           <relativePath/>
       </parent>
   
       <dependencies>
           <dependency>
               <groupId>org.springframework.boot</groupId>
               <artifactId>spring-boot-starter-web</artifactId>
           </dependency>
           <dependency>
               <groupId>org.springframework.boot</groupId>
               <artifactId>spring-boot-starter-data-mongodb</artifactId>
           </dependency>
           <dependency>
               <groupId>org.springframework.boot</groupId>
               <artifactId>spring-boot-starter-data-redis</artifactId>
           </dependency>
           <dependency>
               <groupId>org.springframework.boot</groupId>
               <artifactId>spring-boot-starter-data-elasticsearch</artifactId>
           </dependency>
   
           <dependency>
               <groupId>com.spring4all</groupId>
               <artifactId>swagger-spring-boot-starter</artifactId>
               <version>1.9.0.RELEASE</version>
           </dependency>
           <dependency>
               <groupId>com.auth0</groupId>
               <artifactId>java-jwt</artifactId>
               <version>3.4.0</version>
           </dependency>
           <dependency>
               <groupId>org.springframework.boot</groupId>
               <artifactId>spring-boot-devtools</artifactId>
               <optional>true</optional> <!-- 这个需要为 true 热部署才有效 -->
           </dependency>
   
       </dependencies>
   
       <build>
           <plugins>
               <plugin>
                   <groupId>org.springframework.boot</groupId>
                   <artifactId>spring-boot-maven-plugin</artifactId>
                   <configuration>
                       <fork>true</fork>
                   </configuration>
               </plugin>
           </plugins>
       </build>
   
   
   </project>
   ```

   

2. 添加配置文件

   `application.yml`

   ```yml
   spring:
     data:
       mongodb:
         uri: mongodb://192.168.2.88:27017/recommender
         elasticsearch:
         cluster-name: book-elasticsearch
         cluster-nodes: 192.168.2.88:9300
   
     redis:
       port: 6379
       host: 192.168.2.88
       timeout: 5000
       database: 0
       password:
     devtools:
       restart:
         enabled: true
         additional-paths: src/main/java
   server:
     port: 8080
   
   swagger:
     title: 基于大数据技术的图书推荐系统RESTful APIs
     description: 使用Swagger2构建的Api文档
     version: 1.0
     terms-of-service-url: https://github.com/Wanfengyueluo/BookRecommenderSystem
     contact:
       name: wanfeng
       email: wanfengyueluo@qq.com
     base-package: com.wan
     base-path: /**
   ```
   `logback.xml`

   ```xml
   <?xml version="1.0" encoding="UTF-8" ?>
   
   <configuration scan="true" scanPeriod="3 seconds">
       <!--设置日志输出为控制台-->
       <appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender">
           <encoder>
               <pattern>%d{yyyy-MM-dd HH:mm:ss.SSS} %-5level [%X{userId}] [%X{requestId}] %logger - %msg%n</pattern>
           </encoder>
       </appender>
   
       <!--设置日志输出为文件-->
       <appender name="FILE" class="ch.qos.logback.core.rolling.RollingFileAppender">
           <File>/home/wan/system.log</File>
           <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
               <FileNamePattern>logFile.%d{yyyy-MM-dd_HH-mm}.log.zip</FileNamePattern>
           </rollingPolicy>
   
           <layout class="ch.qos.logback.classic.PatternLayout">
               <Pattern>%d{HH:mm:ss,SSS} [%thread] %-5level %logger{32} - %msg%n</Pattern>
           </layout>
       </appender>
   
       <root>
           <level value="INFO"/>
           <appender-ref ref="STDOUT"/>
           <appender-ref ref="FILE"/>
       </root>
   
   
   </configuration>
   
   ```

   

3. 主要实现

4. 启动

   >启动之前，需要启动MongoDB、Redis

关于ES，需要在项目启动后，输入请求 http://localhost:9090/api/es/save 进行数据存储

